#!/bin/bash

function interface_exists()
{
  local interface_name="$1"
  if ip link show "$interface_name" &>/dev/null
  then
    return 0
  fi
  return 1
}

function make_hosts_record()
{
  local ip_address="$1"
  local host_name="$2"
  local hosts_file="/etc/hosts"

  if grep -qE "^[[:space:]]*${ip_address}[[:space:]]+${host_name}(\$|[[:space:]])" "${hosts_file}"
  then
    log_info "[hosts] Record already exists: ${ip_address} <-> ${host_name}"
    return 0
  fi

  if grep -qE "[[:space:]]${host_name}(\$|[[:space:]])" "${hosts_file}"
  then
    sudo sed -i -E "s/^[0-9]+\.[0-9]+\.[0-9]+\.[0-9]+[[:space:]]+${host_name}(\$|[[:space:]].*)/${ip_address}\t${host_name}\1/" "${hosts_file}"
    log_info "[hosts] Record updated: ${ip_address} <-> ${host_name}"
  else
    echo -e "${ip_address} ${host_name}" | sudo tee -a "${hosts_file}" > /dev/null
    log_info "[hosts] Record added: ${ip_address} <-> ${host_name}"
  fi
}
